3.用户 chatrecordlist，记录形式，是否需要单独记录。


添加 实体词的召回模块

公司，产品词之间的领域继承切换，依赖：分类，实体词领域区分

抽象模块： 句式，领域继承




dialog_manage.py:191]dailog_manage return data:{'entrance': '20171', 'matchq': '安联安康无忧医疗保险有哪些交费方式？', 'question_rewrite_segment': ['安联安康无忧医疗保险', '是否', '有', '补偿', '交费方式'], 'data': {'answer': '一次交清', 'question': '安康无忧是否有补偿', 'score': 0.7894736842105263}, 'question_rewrite': '安联安康无忧医疗保险是否有补偿交费方式', 'jdpin': 'jd_696f3e78183ed', 'answerType': '7'}


交互：


根据过滤词表，挖掘同义句，新句进来进行同义替换，直接替换，去掉过滤词替换

和.*差别
跟.*差别


写一个脚本，监控excel语料，  同义词不能同时出现在实体词中

1.结构优化，独立  交互 模块，  问题独立，上一句 多个domain，当前句domain  和 上一句domain多余1个，进行交互



entity_words 加载优化，分领域进行加载。
             有一个总体的合并所有实体词。
             每句话都有分类，根据分类取继承；如果没有分类，如何继承，继承最上面的

公司/--保单/
产品/-- 年龄/
没有--走句式分类

分领域存储slots，继承slots，，继承哪个领域的slots。
    如果当前句有实体词还好，如果没有实体词，需要依赖句式分类。 融合问题？

槽位是否需要根据领域存储redis。不需要，取redis时候只需要根据类别取即可。

句式分类---不同的继承情况--分领域继承。
领域分类--需要继承的当前实体词切换--句式分类--不同的继承情况
    领域分类如果不明确，按照当前分类处理。 领域分类的最大作用是切换实体词

架构调整：建立领域分类，在第一层。 所有的槽位作为储备状态，建立当前槽位状态，根据实际情况切换到当前槽位。

建立用户状态class 管理器，管理 用户状态，赋值，删除，更新
    用户状态：当前领域，当前槽位


当前架构：
    上一个问题的处理--
    预处理--
    槽位挖掘，历史槽位继承--
    交互处理--

完善后架构：
    上一个问题--
    预处理--
    领域分类--
    当前槽位切换--
    槽位挖掘，历史槽位继承--
    交互--



四、上下文
    1. 职业分类表误触发投保要求
    2. 错别字误触发：安联畅游 补全为 安康无忧
    3. 年龄限制：无法识别为intent导致误补全
    4. 退保流程、退保条件、在线退保：分词错误导致无法补全
    5. 产品词误触发 & 错误提问误触发：直接问“安行万里”之类的产品词，会由于上下文补全给出答案



安行万里多大年纪可以投保呀
安行万里境外险多少岁可以投保呀


报销比例  这个词没有
大病范围